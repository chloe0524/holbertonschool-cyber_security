class MetasploitModule < Msf::Post

  def initialize(info = {})
    super(
      update_info(
        info,
        'Name' => 'info gatherererezeere by chlo',
        'License' => MSF_LICENSE
      )
    )
  end

  def run
    print_status("Gathering system information from #{session.session_host}")

    gather_system_info
    gather_user_info
    gather_network_info
    gather_running_processes
  end

  def gather_system_info
    sysinfo = session.sys.config.sysinfo
    print_good("OS: #{sysinfo['OS']}")
    print_good("Computer: #{sysinfo['Computer']}")
  end

  def gather_user_info
    user = session.sys.config.getuid
    print_good("User: #{user}")
  end

  def gather_network_info
    ifaces = session.net.config.interfaces
    ifaces.each do |iface|
      iface.addrs.each do |addr|
        print_good("Interface: #{iface.name}, IP: #{addr.addr}, Netmask: #{addr.netmask}, Broadcast: #{addr.broad}")
      end
    end
  end

  def gather_running_processes
    procs = session.sys.process.get_processes
    procs.each do |proc|
      print_good("Process #{proc['pid']} - #{proc['name']}")
    end
  end
end

